<!DOCTYPE html> 
<html>
<head>
<title>Set Wallpaper Options</title>
<link rel="stylesheet" type="text/css" href="/css/options.css">
<script type="text/javascript">
var bkg = chrome.extension.getBackgroundPage();

/**
* Saves options to localStorage.
*/
function saveOptions() {
  // Save settings.
  bkg.settings.debug = document.getElementById('debug').checked;
  bkg.settings.user_interface = document.getElementById('user_interface').value;
  bkg.settings.position = document.getElementById('position').value;
  
  // Update status to let user know options were saved.
  var info = document.getElementById('info-message');
  info.style.display = 'inline';
  info.style.opacity = 1;
  setTimeout(function() {
    info.style.opacity = 0.0;
  }, 1000);
}

/**
* Restore all options.
*/
function restoreOptions() {
  // Restore settings.
  document.getElementById('version').innerHTML = ' (v' + bkg.settings.version + ')';
  document.getElementById('debug').checked = bkg.settings.debug;
  document.getElementById('position').value = bkg.settings.position;
  var user_interface = document.getElementById('user_interface');
  user_interface.value = bkg.settings.user_interface;
  
  // Add couple of listeners.
  user_interface.addEventListener('change', function(e) {
    var value = this.options[this.selectedIndex].value;
    setUserInterfaceNote(value);
  }, false);
  setUserInterfaceNote(bkg.settings.user_interface);
}

/**
 * Changes the note for the userinterface, to help and assist the user what
 * the options really mean.
 *
 * @param {string} type The type of message that needs to change.
 */
function setUserInterfaceNote(type) {
  var message = 'Error, type does not exist.';
  if (type == 'overlay')
    message = 'Creates an overlay preview within the tab itself.';
  else if (type == 'none')
    message = 'No preview, automatically sets the wallpaper with the default ' +
              'position.';
  else if (type == 'newtab')
    message = 'A new tab page will open with the wallpaper preview screen.';
  document.getElementById('user_interface_note').innerHTML = message;
}
</script>
</head>

<body onload="restoreOptions()"> 
  <form onsubmit="return false;">
  <div id="body-container">
    <div id="header">
      <h1>Set Wallpaper Options<em id="version"></em></h1>
    </div>
    <p>
      Make sure you save the settings after your done editing!
      <a
       href="https://chrome.google.com/extensions/detail/ddkmiidlgnkhnfhigdpadkaamogngkin">
       Visit extension page
      </a>,
      <a
       href="http://groups.google.com/group/mohamedmansour-extensions">
       File bugs and suggestions
      </a>
    </p>
    <div class="extension-template">
      <div class="extension-header">General</div>
      <div class="extension-options">
        <p>Feel free to try out the experimental overlay feature. If it looks
           awkward in some websites, please 
           <a href="http://twitter.com/mohamedmansour">let me</a> know so I can
           look into it. Remember, if you use no user interface (set it to None)
           the only way to visit this page again is through Tools > Extensions.</p>
        <dl>
          <dt>User interface:</dt>
          <dd>
            <select id="user_interface">
              <option value="newtab">New tab page</option>
              <option value="none">None</option>
              <option value="overlay">Overlay (experimental)</option>
            </select>
            <span class="note" id="user_interface_note"></span>
          </dd>
          <dt>Default position:</dt>
          <dd>
            <select id="position">
              <option value="stretch">Stretch</option>
              <option value="center">Center</option>
              <option value="tile">Tile</option>
            </select>
          </dd>
        </dl>
      </div>
    </div>
    <div class="extension-template">
      <div class="extension-header">Debugging</div>
      <div class="extension-options">
        <p>To report a bug to the developer, please enable the debugger below,
           and it will post the debug messages to the "background.html"
           inspector located in chrome://extensions when you click on it on the
           console tab. Once your done reporting, you can uncheck it.</p>
        <dl>
          <dt>Show on console:</dt>
          <dd>
            <label for="debug"><input type="checkbox" id="debug" /></label>
          </dd>
        </dl>
      </div>
    </div>
    <div id="extension-footer">
      <span id="info-message">Options saved!</span>
      <button onclick="saveOptions();">Save</button>
      <button onclick="window.close();">Close</button>
    </div>
    <div id="credits">
      Extension developed by <a href="http://www.mohamedmansour.com">Mohamed Mansour</a>, 
      Source Code available in <a href="http://github.com/mohamedmansour/set-wallpaper-extension">GitHub</a><br/>
      Follow me on Twitter <a href="http://twitter.com/mohamedmansour">@mohamedmansour</a>
    </div>
  </div>
  </form>
</body>
</html>